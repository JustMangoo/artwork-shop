import{A as F}from"./AdminLayout-DefDVgKs.js";import{M as V}from"./Modal-Dobz_Sg4.js";import{I as T}from"./InputError-DCZ6rp5i.js";import{_ as N}from"./InputLabel-C5IakI4U.js";import{_ as A}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{o as d,g as m,b as e,p as S,q as U,Z as E,T as L,s as f,a as n,w as c,F as y,c as B,i as u,d as v,v as C,l as k,x as O,t as p,h as x,y as D}from"./index.esm-BSd0a89p.js";import{_ as j}from"./search-DYZCOKiQ.js";import{_ as H}from"./arrow-CR6mYdnJ.js";import{_ as K}from"./pen-DxR_m5PC.js";import{_ as q}from"./trash-BBH0x-Tu.js";import"./Navigation-DHCB5LAN.js";/* empty css                                                                   */import"./CartSidebar-D12dIBYV.js";/* empty css                                                                    *//* empty css                                                                   */const G="/build/assets/xmark-BhYUfNAS.svg",Z="/build/assets/upload-g58IeUnH.svg",Q={name:"ImageUploadComponent",props:{initialImage:String,imageId:[String,Number],index:Number},data(){return{imagePreviewUrl:null,componentId:this.generateUniqueId()}},created(){console.log(`Component created with imageId: ${this.imageId}, index: ${this.index}, initialImage: ${this.initialImage}`)},mounted(){this.initialImage&&(this.imagePreviewUrl=this.initialImage,this.$emit("image-loaded",{imagePreviewUrl:this.initialImage,id:this.componentId,index:this.index}))},methods:{triggerFileInput(){this.$refs.fileInput.click()},handleImageUpload(t){const i=t.target.files[0];if(i&&i.type.match("image.*")){const r=new FileReader;r.onload=a=>{this.imagePreviewUrl=a.target.result,this.$emit("image-added",{file:i,id:this.componentId,index:this.index})},r.readAsDataURL(i)}},removeImage(){this.$emit("image-removed",{id:this.imageId,index:this.index}),this.imagePreviewUrl=null},generateUniqueId(){return`image-upload-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}}},P=t=>(S("data-v-7ba6f647"),t=t(),U(),t),Y={class:"image-upload-container"},z={key:0,class:"image-preview-container"},J=["src"],W=P(()=>e("img",{src:G,alt:"remove icon"},null,-1)),X=[W],$=P(()=>e("img",{src:Z,alt:"upload"},null,-1)),ee=[$];function ie(t,i,r,a,l,o){return d(),m("div",Y,[l.imagePreviewUrl?(d(),m("div",z,[e("img",{src:l.imagePreviewUrl,class:"image-preview"},null,8,J),e("button",{onClick:i[0]||(i[0]=(...h)=>o.removeImage&&o.removeImage(...h)),class:"remove-image-btn"},X)])):(d(),m("div",{key:1,onClick:i[1]||(i[1]=(...h)=>o.triggerFileInput&&o.triggerFileInput(...h)),class:"image-upload-placeholder"},ee)),e("input",{type:"file",ref:"fileInput",onChange:i[2]||(i[2]=(...h)=>o.handleImageUpload&&o.handleImageUpload(...h)),hidden:""},null,544)])}const te=A(Q,[["render",ie],["__scopeId","data-v-7ba6f647"]]),se="/build/assets/plus-DUQZT4tT.svg",oe={components:{AdminLayout:F,Head:E,Modal:V,InputError:T,InputLabel:N,ImageUploadComponent:te},props:{products:Array,categories:Array},data(){return{isModalOpen:!1,imagePreviewUrls:[],initialImages:[null,null,null],initialImagesId:[null,null,null],isEditMode:!1,messageType:"info",showSearch:!1,isSearchVisible:!1,searchTerm:"",dropdownActive:!1,selectedCategory:null,selectedCategoryName:""}},setup(){return{form:L({id:null,title:"",description:"",price:null,category:"",images:[],removedImages:[]})}},methods:{toggleDropdown(){this.dropdownActive=!this.dropdownActive},selectCategory(t){this.selectedCategory=t.id,this.selectedCategoryName=t.name,this.dropdownActive=!1,this.filterByCategory()},filterByCategory(){this.performSearch()},performSearch(){this.$inertia.get(route("products.index"),{search:this.searchTerm,category:this.selectedCategory},{preserveState:!0,preserveScroll:!0,replace:!0}),this.isSearchVisible=!1,setTimeout(()=>{this.showSearch=!1},300)},resetFilters(){this.searchTerm="",this.selectedCategory=null,this.selectedCategoryName="",this.performSearch()},handleImageAdded(t){console.log("Attempting to add image data:",t),this.form.images.push(t.file),console.log("Current form images after pushing:",this.form.images)},handleImageRemoved(t){if(t.id)this.form.removedImages.push(t.id);else{const i=this.form.images.indexOf(t.file);i!==-1&&this.form.images.splice(i,1)}},removeImage(t){console.log("Attempting to remove image:",t);const{id:i,index:r}=t;r!==void 0&&(console.log(`Removing image at index ${r} from preview URLs.`),this.imagePreviewUrls.splice(r,1),this.form.images.splice(r,1)),i&&(console.log(`Marking image with ID ${i} for deletion.`),this.form.removedImages.push(i))},productImagePath(t){return t.image?"/storage/"+t.image.replace("public/",""):"resources/js/Assets/Images/Image1.png"},addProduct(){let t=new FormData;Object.keys(this.form).forEach(r=>{if(r==="images"&&this.form[r])for(let a=0;a<this.form.images.length;a++)t.append(`images[${a}]`,this.form.images[a]);else r==="removedImages"&&this.form[r]?this.form.removedImages.forEach((a,l)=>{t.append(`removedImages[${l}]`,a)}):t.append(r,this.form[r])}),this.form.id&&t.append("_method","PATCH");const i=this.form.id?route("products.update",this.form.id):route("products.store");this.$inertia.post(i,t,{onSuccess:()=>{this.isModalOpen=!1,this.resetForm(),this.isEditMode=!1},onError:r=>{console.error("There was an error updating the product: ",r)},forceFormData:!0})},closeModal(){this.isModalOpen=!1,this.resetForm()},resetForm(){this.form.reset(),this.initialImages=[null,null,null],this.initialImagesId=[null,null,null],this.isEditMode=!1,this.$refs.fileInput&&(this.$refs.fileInput.value=null),this.initialImage=null,this.initialImageId=null},editProduct(t){for(this.isEditMode=!0,this.resetForm(),this.form.id=t.id,this.form.title=t.title,this.form.description=t.description,this.form.price=t.price,this.form.category=t.category_id,this.initialImages=t.images.map(i=>"/storage/"+i.image.replace("public/","")),this.initialImagesId=t.images.map(i=>i.id);this.initialImages.length<3;)this.initialImages.push(null);this.isModalOpen=!0},deleteProduct(t){confirm(`Are you sure you want to delete ${t.title}?`)&&this.$inertia.delete(route("products.destroy",t.id),{onSuccess:()=>{},onError:i=>{}})}}},g=t=>(S("data-v-dac4b1d7"),t=t(),U(),t),ae={class:"container"},re=g(()=>e("h2",null,"Pievienot Produktu",-1)),le={class:"input-field"},ne={class:"input-field"},de={class:"images-input-box input-field"},me={class:"images-input"},ce={class:"input-field"},ge={class:"categories-input"},he=["id","value","onUpdate:modelValue"],ue=["for"],pe={class:"modal-footer"},fe={class:"header"},_e=g(()=>e("h1",null,"Produkti",-1)),Ie=g(()=>e("img",{src:se,alt:"plus icon"},null,-1)),ve={class:"main-content"},we={class:"filters"},ye={class:"filters-header"},Ce=g(()=>e("h2",null,"Filtrēšana",-1)),be=g(()=>e("g",{id:"SVGRepo_bgCarrier","stroke-width":"0"},null,-1)),ke=g(()=>e("g",{id:"SVGRepo_tracerCarrier","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)),xe=g(()=>e("g",{id:"SVGRepo_iconCarrier"},[e("path",{d:"M3 8H16.5C18.9853 8 21 10.0147 21 12.5C21 14.9853 18.9853 17 16.5 17H3M3 8L6 5M3 8L6 11","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),Ae=[be,ke,xe],Se={class:"search-wrapper"},Ue=g(()=>e("img",{src:j,alt:"search icon"},null,-1)),Pe=[Ue],Me={class:"category-search-container"},Re=g(()=>e("img",{src:H,alt:"arrow-icon"},null,-1)),Fe={key:0,class:"dropdown-content"},Ve=["onClick"],Te={class:"table-container"},Ne={cellspacing:"0",cellpadding:"0"},Ee=g(()=>e("thead",null,[e("tr",null,[e("th",null,"Nosaukums"),e("th",{class:"hide-ssmall"},"raksts"),e("th",null,"Cena"),e("th",{class:"hide-ssmall"},"kategorija"),e("th",null,"Bilde"),e("th")])],-1)),Le={class:"hide-ssmall"},Be={class:"hide-ssmall"},Oe={class:"table-badge"},De={class:"image-cell"},je=["src"],He=["onClick"],Ke=["onClick"];function qe(t,i,r,a,l,o){const h=f("Head"),_=f("InputLabel"),I=f("InputError"),b=f("ImageUploadComponent"),M=f("Modal"),R=f("AdminLayout");return d(),m(y,null,[n(h,{title:"Produkti"}),n(R,null,{default:c(()=>[e("div",ae,[l.isModalOpen?(d(),B(M,{key:0,onClose:o.closeModal,showSidebar:!0},{header:c(()=>[re]),content:c(()=>[e("div",le,[n(_,{for:"title"},{default:c(()=>[u("Nosaukums:")]),_:1}),v(e("input",{type:"text",id:"title","onUpdate:modelValue":i[0]||(i[0]=s=>a.form.title=s)},null,512),[[C,a.form.title]]),n(I,{message:a.form.errors.title},null,8,["message"])]),e("div",ne,[n(_,{for:"description"},{default:c(()=>[u("Apraksts:")]),_:1}),v(e("textarea",{id:"description","onUpdate:modelValue":i[1]||(i[1]=s=>a.form.description=s)},null,512),[[C,a.form.description]]),n(I,{message:a.form.errors.description},null,8,["message"])]),e("div",de,[n(_,{for:"images"},{default:c(()=>[u("Attēli:")]),_:1}),e("div",me,[n(b,{"initial-image":l.initialImages[0],"image-id":l.initialImagesId[0],index:0,onImageAdded:o.handleImageAdded,onImageRemoved:o.handleImageRemoved},null,8,["initial-image","image-id","onImageAdded","onImageRemoved"]),n(b,{"initial-image":l.initialImages[1],"image-id":l.initialImagesId[1],index:1,onImageAdded:o.handleImageAdded,onImageRemoved:o.handleImageRemoved},null,8,["initial-image","image-id","onImageAdded","onImageRemoved"]),n(b,{"initial-image":l.initialImages[2],"image-id":l.initialImagesId[2],index:2,onImageAdded:o.handleImageAdded,onImageRemoved:o.handleImageRemoved},null,8,["initial-image","image-id","onImageAdded","onImageRemoved"])])]),n(I,{message:a.form.images.price,class:"mt-2"},null,8,["message"])]),"side-content":c(()=>[e("div",ce,[n(_,{for:"price"},{default:c(()=>[u("Cena:")]),_:1}),v(e("input",{type:"number",id:"price","onUpdate:modelValue":i[2]||(i[2]=s=>a.form.price=s)},null,512),[[C,a.form.price]]),n(I,{message:a.form.errors.price},null,8,["message"])]),e("div",null,[n(_,{for:"category"},{default:c(()=>[u("Kategorijas:")]),_:1}),e("div",ge,[(d(!0),m(y,null,k(r.categories,s=>(d(),m("div",{key:s.id,class:"radio-tag"},[v(e("input",{type:"radio",id:"category-"+s.id,value:s.id,"onUpdate:modelValue":w=>a.form.category=w,name:"category"},null,8,he),[[O,a.form.category]]),e("label",{for:"category-"+s.id,class:"tag-label"},p(s.name),9,ue)]))),128))]),n(I,{message:a.form.errors.category},null,8,["message"])])]),footer:c(()=>[e("div",pe,[e("button",{class:"btn-secondary",onClick:i[3]||(i[3]=s=>{l.isModalOpen=!1,o.resetForm()})}," Atcelt "),e("button",{class:"btn-primary",onClick:i[4]||(i[4]=(...s)=>o.addProduct&&o.addProduct(...s))}," Saglabāt ")])]),_:1},8,["onClose"])):x("",!0),e("header",fe,[_e,e("button",{class:"add-button",onClick:i[5]||(i[5]=s=>l.isModalOpen=!0)},[Ie,u(" Pievienot ")])]),e("div",ve,[e("aside",we,[e("div",ye,[Ce,(d(),m("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",onClick:i[6]||(i[6]=(...s)=>o.resetFilters&&o.resetFilters(...s))},Ae))]),e("div",Se,[v(e("input",{"onUpdate:modelValue":i[7]||(i[7]=s=>l.searchTerm=s),type:"text",class:"search-input",onKeyup:i[8]||(i[8]=D((...s)=>o.performSearch&&o.performSearch(...s),["enter"]))},null,544),[[C,l.searchTerm]]),e("button",{class:"search-button",onClick:i[9]||(i[9]=(...s)=>o.performSearch&&o.performSearch(...s))},Pe)]),e("div",Me,[e("div",{onClick:i[10]||(i[10]=(...s)=>o.toggleDropdown&&o.toggleDropdown(...s)),class:"dropdown-button"},[u(p(l.selectedCategoryName||"Kategorijas")+" ",1),Re]),l.dropdownActive?(d(),m("div",Fe,[(d(!0),m(y,null,k(r.categories,s=>(d(),m("div",{key:s.id,onClick:w=>o.selectCategory(s),class:"dropdown-item"},p(s.name),9,Ve))),128))])):x("",!0)])]),e("div",Te,[e("table",Ne,[Ee,e("tbody",null,[(d(!0),m(y,null,k(r.products,s=>(d(),m("tr",{key:s.id},[e("td",null,p(s.title),1),e("td",Le,p(s.description),1),e("td",null,p(s.price)+"€",1),e("td",Be,[e("div",Oe,p(s.category.name),1)]),e("td",null,[e("div",De,[s.images.length>0?(d(),m("img",{key:0,src:o.productImagePath(s.images[0]),alt:"Product Image",class:"table-image"},null,8,je)):x("",!0)])]),e("td",null,[e("img",{class:"action-btn",src:K,alt:"edit-icon",onClick:w=>o.editProduct(s)},null,8,He),e("img",{class:"action-btn",src:q,alt:"delete-icon",onClick:w=>o.deleteProduct(s)},null,8,Ke)])]))),128))])])])])])]),_:1})],64)}const ri=A(oe,[["render",qe],["__scopeId","data-v-dac4b1d7"]]);export{ri as default};
